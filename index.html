<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Standalone Google Sheet Counter</title>
<style>
body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 40px; color: #333; }
h1 { text-align: center; color: #1a73e8; }
#result {
  background: #fff; border-radius: 10px; padding: 20px; max-width: 400px; margin: 30px auto;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1); font-size: 18px; line-height: 1.6;
}
object { display:none; }
</style>
</head>
<body>
<h1>Auto Count Names (Column B)</h1>
<div id="result">Loading data...</div>

<object id="csvFrame" data="https://docs.google.com/spreadsheets/d/e/2PACX-1vRgjGiwz_YAGf5XkE77TTP5BydKRO_Dp1I95wRFkUGS4M36kX1hpQWotXy5NHi7yg5HkWDpUDufZK2p/pub?output=csv"></object>

<script>
document.getElementById("csvFrame").addEventListener("load", async function() {
  try {
    const frameDoc = this.contentDocument || this.contentWindow.document;
    const text = frameDoc.body.innerText;
    const rows = text.split(/\r?\n/).slice(1); // skip header row
    const counts = {};

    for (let r of rows) {
      const cols = r.split(",");
      const name = cols[1]?.trim();
      if (name) counts[name] = (counts[name] || 0) + 1;
    }

    const sorted = Object.entries(counts).sort((a,b) => b[1] - a[1]);
    document.getElementById("result").innerHTML = sorted.length
      ? sorted.map(([n,c]) => `${n} = ${c}`).join("<br>")
      : "No names found.";
  } catch (e) {
    document.getElementById("result").textContent = "‚ùå Cannot access sheet due to browser security (CORS). Try hosting this HTML online (GitHub Pages, Netlify, etc.)";
  }
});
</script>
</body>
</html>
